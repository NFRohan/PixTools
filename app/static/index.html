<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PixTools</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;800&family=Space+Mono:ital,wght@0,400;0,700;1,400;1,700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="/static/style.css">
    <link rel="icon" type="image/x-icon" href="data:image/x-icon;,">
</head>
<body>
    <main class="container">
        <!-- Header -->
        <header class="header card-neo bg-white">
            <h1 class="logo-text">â–  PIXTOOLS</h1>
            <p class="tagline">Hybrid-cloud image processing pipeline</p>
        </header>

        <!-- Main Workspace Area -->
        <div id="workspace" class="workspace-grid">
            
            <!-- Column 1: Upload Zone -->
            <div class="col-upload">
                <div id="drop-zone" class="card-neo bg-yellow upload-area">
                    <input type="file" id="file-input" accept="image/jpeg, image/png, image/webp, image/avif" hidden>
                    <div id="upload-prompt">
                        <span class="icon-large">ðŸ“¥</span>
                        <h2>DROP IMAGE HERE</h2>
                        <p>or click to browse<br><small>(JPG, PNG, WEBP, AVIF max 10MB)</small></p>
                    </div>
                    <img id="image-preview" class="preview-img hidden" src="" alt="Preview">
                    <button id="btn-remove-preview" class="btn-circular hidden" title="Remove image">âœ•</button>
                    <!-- Inline error container -->
                    <div id="upload-error" class="error-toast hidden"></div>
                </div>
            </div>

            <!-- Column 2: Operations & Controls -->
            <div class="col-controls">
                <div class="card-neo bg-white controls-panel">
                    <h3>OPERATIONS</h3>
                    <div class="ops-grid">
                        <label class="op-checkbox default-op">
                            <input type="checkbox" name="operation" value="jpg">
                            <span class="op-box"></span>
                            <span class="op-label">JPG</span>
                        </label>
                        <label class="op-checkbox default-op">
                            <input type="checkbox" name="operation" value="png">
                            <span class="op-box"></span>
                            <span class="op-label">PNG</span>
                        </label>
                        <label class="op-checkbox default-op">
                            <input type="checkbox" name="operation" value="webp">
                            <span class="op-box"></span>
                            <span class="op-label">WEBP</span>
                        </label>
                        <label class="op-checkbox default-op">
                            <input type="checkbox" name="operation" value="avif">
                            <span class="op-box"></span>
                            <span class="op-label">AVIF</span>
                        </label>
                        <label class="op-checkbox ai-op">
                            <input type="checkbox" name="operation" value="denoise">
                            <span class="op-box"></span>
                            <span class="op-label">DENOISE (AI)</span>
                        </label>
                        <label class="op-checkbox default-op">
                            <input type="checkbox" name="operation" value="metadata">
                            <span class="op-box"></span>
                            <span class="op-label">METADATA (EXIF)</span>
                        </label>
                    </div>
                    <!-- Inline error container -->
                    <div id="ops-error" class="error-toast hidden"></div>

                    <div id="advanced-controls" class="advanced-controls hidden">
                        <h4>Parameters</h4>

                        <div id="quality-control" class="param-row hidden">
                            <label for="quality-range">Quality</label>
                            <input id="quality-range" type="range" min="1" max="100" value="80">
                            <span id="quality-value" class="mono-text">80</span>
                        </div>

                        <div id="resize-control" class="param-row">
                            <label for="resize-width">Resize</label>
                            <div class="resize-group">
                                <input id="resize-width" type="number" min="1" step="1" placeholder="width">
                                <input id="resize-height" type="number" min="1" step="1" placeholder="height">
                            </div>
                        </div>

                        <div class="param-row">
                            <label for="webhook-url">Webhook URL</label>
                            <input id="webhook-url" type="url" placeholder="https://example.com/hook">
                        </div>
                    </div>
                </div>

                <!-- Process Button States -->
                <button id="btn-process" class="btn-neo btn-primary" disabled>
                    PROCESS <span>â–º</span>
                </button>
                
                <div id="process-indicator" class="card-neo bg-cyan hidden processing-box">
                    <div class="spinner"></div>
                    <div class="processing-text">
                        <h3>PROCESSING</h3>
                        <p id="job-id-display" class="mono-text small-text">job-id-here</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- Current Results Area (Hidden initially) -->
        <section id="results-section" class="results-area hidden">
            <div class="results-header card-neo bg-white">
                <h2>RESULTS</h2>
                <div class="results-actions">
                    <a id="btn-download-all" href="#" class="btn-neo btn-secondary btn-small hidden" download>DOWNLOAD ALL (.ZIP)</a>
                    <button id="btn-process-another" class="btn-neo btn-secondary btn-small">PROCESS ANOTHER -></button>
                </div>
            </div>
            <!-- Sub-error banner if webhook failed but polling succeeded -->
            <div id="webhook-warning" class="error-toast hidden bg-yellow">
                âš  Webhook delivery failed, but results are available below.
            </div>
            <div id="result-cards-container" class="results-grid">
                <!-- Cards injected here via JS -->
            </div>
            <div id="metadata-panel" class="card-neo bg-white hidden">
                <h3>METADATA</h3>
                <div id="metadata-content" class="metadata-content"></div>
            </div>
        </section>

        <!-- Previous Jobs Area (Hidden initially) -->
        <section id="history-section" class="history-area hidden mt-loose">
            <div class="history-header">
                <h3 class="history-title">â”€â”€ PREVIOUS JOBS â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€</h3>
                <button id="btn-clear-history" class="btn-neo btn-secondary btn-small">CLEAR HISTORY</button>
            </div>
            <div id="history-container" class="history-list">
                <!-- History items injected here via JS -->
            </div>
        </section>

    </main>

    <!-- Template for Result Card -->
    <template id="tpl-result-card">
        <div class="card-neo result-card">
            <div class="card-header">
                <h3 class="op-name">TYPE</h3>
            </div>
            <div class="img-preview-container">
                <img class="result-img" src="" alt="Result" loading="lazy">
            </div>
            <a href="#" class="btn-neo btn-download" download>DOWNLOAD â†“</a>
        </div>
    </template>

    <!-- Template for History Item -->
    <template id="tpl-history-item">
        <div class="card-neo bg-white history-item">
            <div class="history-meta">
                <span class="history-id mono-text">id</span>
                <span class="history-ops">ops</span>
            </div>
            <div class="history-links">
                <!-- Download links injected here -->
            </div>
        </div>
    </template>

    <script src="/static/app.js"></script>
</body>
</html>

